# This is an example .goreleaser.yml file with some sensible defaults.
# Make sure to check the documentation at https://goreleaser.com

# The lines below are called `modelines`. See `:help modeline`
# Feel free to remove those if you don't want/need to use them.
# yaml-language-server: $schema=https://goreleaser.com/static/schema.json
# vim: set ts=2 sw=2 tw=0 fo=cnqoj

version: 2
project_name: spage

before:
  hooks:
    # You may remove this if you don't use go modules.
    - go mod tidy

builds:
  - id: spage
    main: ./main.go
    binary: spage
    env:
      - CGO_ENABLED=0
    goos:
      - linux
      - darwin
    goarch:
      - amd64
      - arm64
    # Set build flags for smaller binaries and better performance
    ldflags:
      - -s -w -X github.com/AlexanderGrooff/spage/cmd.Version={{.Version}} -X github.com/AlexanderGrooff/spage/cmd.GitCommit={{.Commit}} -X github.com/AlexanderGrooff/spage/cmd.BuildDate={{.Date}}

archives:
  - formats: [tar.gz]
    # this name template makes the OS and Arch compatible with the results of `uname`.
    name_template: >-
      {{ .ProjectName }}_
      {{- .Os }}_
      {{- .Arch }}
    # use zip for windows archives
    format_overrides:
      - goos: windows
        formats: [zip]

nfpms:
  - id: spage
    package_name: spage
    maintainer: "Alexander Grooff <alexandergrooff@gmail.com>"
    description: "Spage â€“ High-performance Ansible-compatible playbook runner"
    homepage: "https://spage.dev"
    license: GPL-3.0
    formats: [apk, deb, rpm, archlinux]
    bindir: /usr/bin
    section: utils
    priority: optional
    provides:
      - spage

changelog:
  sort: asc
  groups:
    - title: "Features"
      regexp: "^feat(.*):"
    - title: "Fixes"
      regexp: "^fix(.*):"
    - title: "Performance"
      regexp: "^perf(.*):"
    - title: "Docs"
      regexp: "^docs(.*):"
    - title: "Chore"
      regexp: "^chore(.*):"

release:
  github:
    owner: AlexanderGrooff
    name: spage
  # Customize the release notes
  header: |
    ## Spage {{ .Tag }} Release

    This release includes the following changes:
  footer: |
    ## Installation

    ### Binary Downloads
    Download the appropriate binary for your platform from the assets below.

    ### Package Managers

    **Linux Package Managers:**
    - `.deb` packages for Debian/Ubuntu
    - `.rpm` packages for RHEL/CentOS/Fedora
    - `.apk` packages for Alpine Linux
    - Arch Linux packages

    For more installation options, visit [spage.dev](https://spage.dev).
