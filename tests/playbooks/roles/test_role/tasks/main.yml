- name: Task in Role
  shell:
    execute: echo "Task in Role" > /tmp/spage/include_role_task.txt

- name: Task in Role with vars
  assert:
    that:
      - role_wide_var == 123

- name: Task in Role with template
  template:
    src: role_template.yaml
    dest: /tmp/spage/include_role_template.txt

- name: slurp template
  slurp:
    src: /tmp/spage/include_role_template.txt
  register: template_content
  after: Task in Role with template

- name: assert template content  
  assert:
    that:
      - template_content.content | b64decode == "some template\n"
  after: slurp template

- name: Task in Role with file copy
  copy:
    src: rolefile.txt
    dest: /tmp/spage/include_role_config.txt

- name: slurp config file
  slurp:
    src: /tmp/spage/include_role_config.txt
  register: config_content
  after: Task in Role with file copy

- name: assert config content
  assert:
    that:
      - '"text in role file" in (config_content.content | b64decode)'
  after: slurp config file
  